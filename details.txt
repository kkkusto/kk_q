import streamlit as st
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Load the data
@st.cache
def load_data():
    data = pd.read_csv('data.csv')
    data['Date'] = pd.to_datetime(data['Date']).dt.date  # Ensure the Date column is in date format
    return data

data = load_data()

# Title for the Streamlit app
st.title('Duration per Job per Date')

# Aggregating duration by job and date. You can adjust this aggregation to sum, mean, etc., based on your requirements.
agg_data = data.groupby(['Date', 'JOB'], as_index=False)['DURATION'].sum()

# Plotting
plt.figure(figsize=(12, 6))
sns.barplot(x='Date', y='DURATION', hue='JOB', data=agg_data, palette='viridis')
plt.xticks(rotation=45)
plt.title('Duration per Job per Date')
plt.xlabel('Date')
plt.ylabel('Duration')

# Show the plot in the Streamlit app
st.pyplot(plt)
